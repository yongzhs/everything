Version 4
SHEET 1 880 680
WIRE 480 0 352 0
WIRE 480 32 480 0
WIRE -48 128 -128 128
WIRE 48 128 -48 128
WIRE 352 128 352 0
WIRE -128 144 -128 128
WIRE 288 144 112 144
WIRE 304 144 288 144
WIRE 480 144 480 112
WIRE -240 160 -240 144
WIRE -240 160 -304 160
WIRE 48 160 32 160
WIRE -304 176 -304 160
WIRE -240 176 -240 160
WIRE -128 256 -128 224
WIRE 352 256 352 224
WIRE 32 272 32 160
WIRE 112 272 32 272
WIRE 176 272 112 272
WIRE 352 272 352 256
WIRE 352 272 256 272
WIRE 432 272 352 272
WIRE 592 272 576 272
WIRE 352 304 352 272
WIRE 352 400 352 384
FLAG 352 400 0
FLAG 480 144 0
FLAG 352 256 out
FLAG -128 256 0
FLAG -240 64 Vcc
FLAG -304 176 0
FLAG -240 256 Vee
FLAG 80 112 Vcc
FLAG 80 176 Vee
FLAG 288 144 gate
FLAG 112 272 fb
FLAG 592 272 0
FLAG -48 128 Vref
SYMBOL Opamps\\opamp2 80 80 R0
SYMATTR InstName U1
SYMATTR Value LM358
SYMBOL pmos 304 224 M180
SYMATTR InstName M1
SYMATTR Value IRF9640
SYMBOL res 336 288 R0
SYMATTR InstName R1
SYMATTR Value 1K
SYMBOL voltage 480 16 R0
SYMATTR InstName V1
SYMATTR Value 7
SYMBOL voltage -128 128 R0
WINDOW 0 36 52 Left 2
WINDOW 3 44 77 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 0
SYMBOL voltage -240 48 R0
SYMATTR InstName V3
SYMATTR Value 15
SYMBOL voltage -240 160 R0
SYMATTR InstName V4
SYMATTR Value 15
SYMBOL cap 432 288 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C1
SYMATTR Value 10µ
SYMBOL res 592 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 0.1
SYMBOL voltage 160 272 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 -32 56 VBottom 2
WINDOW 123 -56 56 VBottom 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 0V
SYMATTR Value2 AC 1
TEXT -120 392 Left 2 !.inc F:\\lm358.lib
TEXT -120 416 Left 2 !;tran 1m uic
TEXT -120 368 Left 2 !.ac dec 10 1 100Meg